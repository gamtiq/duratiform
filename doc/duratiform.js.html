<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>duratiform Source: duratiform.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">duratiform</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-duratiform.html">duratiform</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: duratiform.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">/**
 * @module duratiform 
 */

/**
 * Separate time duration into parts.
 * 
 * @param {Integer} nDuration
 *      Time duration in milliseconds.
 * @param {Integer} [nPartQty]
 *      Parts quantity. The default value is 3.
 *      The following values are allowed:
 *      &lt;ul>
 *      &lt;li>&lt;code>1&lt;/code> - return seconds quantity (&lt;code>second&lt;/code> field)
 *      &lt;li>&lt;code>2&lt;/code> - return quantity of minutes and seconds (&lt;code>minute&lt;/code> and &lt;code>second&lt;/code> fields)
 *      &lt;li>&lt;code>3&lt;/code> - return quantity of hours, minutes and seconds (&lt;code>hour&lt;/code>, &lt;code>minute&lt;/code> and &lt;code>second&lt;/code> fields)
 *      &lt;li>&lt;code>4&lt;/code> - return quantity of days, hours, minutes and seconds (&lt;code>day&lt;/code>, &lt;code>hour&lt;/code>, &lt;code>minute&lt;/code> and &lt;code>second&lt;/code> fields)
 *      &lt;/ul>
 * @param {Boolean} [bAddStrings]
 *      Specifies whether additional string fields should be included into result object.
 *      An additional field represents a value of calculated part that is converted into string 
 *      and is prefixed with "0" if it is necessary (i.e. values from 0 to 9 are converted to "00"-"09").
 *      The default value is &lt;code>false&lt;/code>.
 * @return {Object}
 *      Object representing the requested parts of time duration. Can contain the following fields.
 *      &lt;table class="params">
 *          &lt;tr>
 *              &lt;th>Name&lt;/th>
 *              &lt;th>Type&lt;/th>
 *              &lt;th>Description&lt;/th>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>day&lt;/td>
 *              &lt;td>Integer&lt;/td>
 *              &lt;td>Quantity of full days&lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>day2&lt;/td>
 *              &lt;td>String&lt;/td>
 *              &lt;td>
 *                  Quantity of full days. String contains at least 2 characters. 
 *                  This field is included only when &lt;code>bAddStrings&lt;/code> has &lt;code>true&lt;/code> value.
 *              &lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>hour&lt;/td>
 *              &lt;td>Integer&lt;/td>
 *              &lt;td>Quantity of full hours&lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>hour2&lt;/td>
 *              &lt;td>String&lt;/td>
 *              &lt;td>
 *                  Quantity of full hours. String contains at least 2 characters. 
 *                  This field is included only when &lt;code>bAddStrings&lt;/code> has &lt;code>true&lt;/code> value.
 *              &lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>minute&lt;/td>
 *              &lt;td>Integer&lt;/td>
 *              &lt;td>Quantity of full minutes&lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>minute2&lt;/td>
 *              &lt;td>String&lt;/td>
 *              &lt;td>
 *                  Quantity of full minutes. String contains at least 2 characters. 
 *                  This field is included only when &lt;code>bAddStrings&lt;/code> has &lt;code>true&lt;/code> value.
 *              &lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>second&lt;/td>
 *              &lt;td>Integer&lt;/td>
 *              &lt;td>Quantity of full seconds&lt;/td>
 *          &lt;/tr>
 *          &lt;tr>
 *              &lt;td>second2&lt;/td>
 *              &lt;td>String&lt;/td>
 *              &lt;td>
 *                  Quantity of full seconds. String contains at least 2 characters. 
 *                  This field is included only when &lt;code>bAddStrings&lt;/code> has &lt;code>true&lt;/code> value.
 *              &lt;/td>
 *          &lt;/tr>
 *      &lt;/table>
 * @alias module:duratiform.divide
 */
function divide(nDuration, nPartQty, bAddStrings) {
    var result = {};
    
    function getPart(sField, nDivisor) {
        var nV;
        if (nDuration >= nDivisor) {
            nV = result[sField] = Math.floor(nDuration / nDivisor);
            nDuration = nDuration % nDivisor;
        }
        else {
            nV = result[sField] = 0;
        }
        if (bAddStrings) {
            result[sField + "2"] = nV &lt; 10 ? "0" + nV : String(nV);
        }
    }
    
    // Convert duration to seconds
    nDuration = nDuration * 0.001;
    if (! nPartQty) {
        nPartQty = 3;
    }
    
    // Extract days
    if (nPartQty > 3) {
        getPart("day", 86400);
    }
    // Extract hours
    if (nPartQty > 2) {
        getPart("hour", 3600);
    }
    // Extract minutes
    if (nPartQty > 1) {
        getPart("minute", 60);
    }
    // Extract seconds
    if (nPartQty > 0) {
        getPart("second", 1);
    }
    return result;
}

/**
 * Convert time duration into string.
 * 
 * @param {Integer} nDuration
 *      Time duration in milliseconds.
 * @param {String} [sFormat]
 *      Format of the returned value. The default value is &lt;code>hh:mm:ss&lt;/code>.&lt;br>
 *      The following tokens are interpreted in special way:
 *      &lt;ul>
 *      &lt;li>&lt;code>\x&lt;/code> - replaced by &lt;code>x&lt;/code>, where &lt;code>x&lt;/code> is any character
 *      &lt;li>&lt;code>d&lt;/code> - quantity of days (1 or more characters)
 *      &lt;li>&lt;code>dd&lt;/code> - quantity of days (2 or more characters)
 *      &lt;li>&lt;code>h&lt;/code> - quantity of hours (1 or more characters)
 *      &lt;li>&lt;code>hh&lt;/code> - quantity of hours (2 or more characters)
 *      &lt;li>&lt;code>m&lt;/code> - quantity of minutes (1 or more characters)
 *      &lt;li>&lt;code>mm&lt;/code> - quantity of minutes (2 or more characters)
 *      &lt;li>&lt;code>s&lt;/code> - quantity of seconds (1 or more characters)
 *      &lt;li>&lt;code>ss&lt;/code> - quantity of seconds (2 or more characters)
 *      &lt;li>&lt;code>[&lt;/code> - cancel special processing of the following characters (except &lt;code>\x&lt;/code> and &lt;code>]&lt;/code>);
 *              this character won't be included into the result
 *      &lt;li>&lt;code>]&lt;/code> - restore special processing that was previously cancelled by &lt;code>[&lt;/code> character;
 *              this character won't be included into the result;
 *              thus any sequence of characters that is surrounded by square brackets (except &lt;code>\x&lt;/code> and &lt;code>]&lt;/code>)
 *              will be included into the result as is but without brackets
 *      &lt;li>&lt;code>(x:&lt;/code> - where &lt;code>x&lt;/code> is one of &lt;code>d&lt;/code> (days), &lt;code>h&lt;/code> (hours),
 *              &lt;code>m&lt;/code> (minutes) or &lt;code>s&lt;/code> (seconds), begin group of characters
 *              that will be included in the result only when the corresponding part of duration is present (above 0)
 *      &lt;li>&lt;code>)&lt;/code> - end of previous group; thus by using format &lt;code>(h:h:)mm:ss&lt;/code> hours part
 *              will be in result only when duration is greater than 60 minutes
 *      &lt;/ul>
 *      All other characters will be included into the result as is.
 * @return {String}
 *      String representing time duration depending of format.
 * @alias module:duratiform.format
 */
function format(nDuration, sFormat) {
    /*jshint boss:true, laxbreak:true*/
    var result = [],
        bReplace = true,
        group = null,
        groupList = [],
        nP = 0,
        specialChar = {
            d: ["day", 4],
            h: ["hour", 3],
            m: ["minute", 2],
            s: ["second", 1]
        },
        sSlash = "\\",
        nI, nK, nL, sChar, part, struct;
    
    function getPart() {
        var group = this.g;
        return ! group || struct[group]
            ? this.c || String(struct[this.p])
            : "";
    }

    if (! sFormat) {
        sFormat = "hh:mm:ss";
    }
    // Scan format string and find positions for replacement
    for (nI = 0, nL = sFormat.length, nK = nL - 1; nI &lt; nL; nI++) {
        sChar = sFormat.charAt(nI);
        // Special character
        if (bReplace &amp;&amp; sChar in specialChar) {
            struct = specialChar[sChar];
            // Save value that will be replaced:
            // 2 or more characters
            if (sFormat.charAt(nI + 1) === sChar) {
                part = struct[0] + "2";
                nI++;
            }
            // 1 or more characters
            else {
                part = struct[0];
            }
            result.push({p: part, g: group, toString: getPart});
            // Change quantity of time duration parts if it is necessary
            if (struct[1] > nP) {
                nP = struct[1];
            }
        }
        // Cancel special processing
        else if (bReplace &amp;&amp; sChar === "[") {
            bReplace = false;
        }
        // Restore special processing
        else if (! bReplace &amp;&amp; sChar === "]") {
            bReplace = true;
        }
        // Start of a group
        else if (bReplace &amp;&amp; sChar === "(" &amp;&amp; sFormat.charAt(nI + 2) === ":"
                &amp;&amp; (part = sFormat.charAt(nI + 1).match(/d|h|m|s/))) {
            if (group) {
                groupList.push(group);
            }
            group = specialChar[part[0]][0];
            nI += 2;
        }
        // End of a group
        else if (bReplace &amp;&amp; group &amp;&amp; sChar === ")") {
            group = groupList.length
                ? groupList.pop()
                : null;
        }
        // Any other character or escaped character
        else if (sChar !== sSlash || nI &lt; nK) {
            // Escaped character
            if (sChar === sSlash) {
                sChar = sFormat.charAt(++nI);
            }
            result.push(
                group
                    ? {g: group, c: sChar, toString: getPart}
                    : sChar
            );
        }
    }
    // Get parts of duration if it is necessary
    if (nP) {
        struct = divide(nDuration, nP, true);
    }
    return result.join("");
}

//Exports

module.exports = {
    divide: divide,
    format: format
};
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	Copyright (c) 2013-2018 Denis Sikuler
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
	
		on 2018-12-22T10:59:22+03:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>
